# This YAML file is a declarative manifest that describes the setup
# of an AutoKitteh sample project that demonstrates integration with
# Gmail, ChatGPT, and Slack.

version: v1

project:
  name: anthropic_slack_thread_tldr

  vars:
    - # The invocation command to trigger the agent from slack.
      # It will always be prefixed with '!'.
      name: INVOCATION_CMD
      value: "tldr"
    - name: ANTHROPIC_API_KEY
      secret: true
      # Put here your Anthropic API key.
      value: "your_anthropic_api_key_here"
    - # Maximum number of tokens to use per invocation.
      name: MAX_TOKENS
      value: "1000"

  connections:
    # We use Slack to interact with the users.
    - name: slack
      integration: slack

  triggers:
    # on_slack_thread_message message will be triggered on every `message` event
    # that is a reply to a thread and starts with `!`.
    - name: slack_message
      connection: slack
      event_type: message
      filter: "data.thread_ts != '' && data.text.startsWith('!')"
      call: workflow.py:on_slack_thread_message
